<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Undian</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) { document.documentElement.classList.add('dark'); } else { document.documentElement.classList.remove('dark'); }
    </script>
    <style>
        body { font-family: 'Poppins', sans-serif; }
        .text-gradient { background: linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .dark .text-gradient { background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen p-5 transition-colors duration-300">

    <button id="theme-toggle" class="fixed top-5 right-5 p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none z-10"></button>

    <div class="w-full max-w-3xl p-8 bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-2xl shadow-lg border border-white/30 dark:border-gray-700/50">
        <h1 class="text-3xl font-bold text-center mb-6 text-gradient">Generator Nomor Undian</h1>

        <div class="flex flex-col sm:flex-row gap-4 mb-6">
            <div class="flex-1">
                <label for="maxAngka" class="block mb-1 font-semibold text-gray-700 dark:text-gray-300">Total Nomor Undian:</label>
                <input type="number" id="maxAngka" min="1" value="100" class="w-full p-2 text-center bg-white/80 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-purple-500">
            </div>
            <div class="flex-1">
                <label for="maxDraw" class="block mb-1 font-semibold text-gray-700 dark:text-gray-300">Jumlah Pengambilan:</label>
                <input type="number" id="maxDraw" min="1" value="10" class="w-full p-2 text-center bg-white/80 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-purple-500">
            </div>
        </div>

        <div id="result" class="min-h-[100px] flex items-center justify-center text-7xl font-bold p-4 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg shadow-lg">-</div>

        <div class="flex flex-col sm:flex-row gap-3 mt-6">
            <button id="drawButton" onclick="generateLotteryNumber()" class="flex-1 py-3 text-lg text-white bg-green-500 rounded-lg hover:bg-green-600 transition-colors shadow-md disabled:bg-green-400 dark:disabled:bg-green-700">Ambil Nomor</button>
            <button id="resetButton" onclick="initializeNumbers()" class="flex-1 py-3 text-lg text-white bg-gray-500 rounded-lg hover:bg-gray-600 transition-colors shadow-md">Reset Undian</button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
            <div class="bg-gray-200/80 dark:bg-gray-700/80 p-4 rounded-lg">
                <h2 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Nomor Terambil (<span id="drawCount">0</span>/<span id="maxDrawValue">10</span>):</h2>
                <div id="history" class="flex flex-wrap gap-2 min-h-[40px]"></div>
            </div>
            <div class="bg-gray-200/80 dark:bg-gray-700/80 p-4 rounded-lg">
                <h2 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Nomor Tersisa:</h2>
                <div id="remaining" class="flex flex-wrap gap-2 max-h-32 overflow-y-auto"></div>
            </div>
        </div>

        <div class="text-center mt-6">
            <a href="index.html" class="text-purple-600 dark:text-purple-400 hover:text-blue-500 font-semibold transition-colors">Kembali ke Menu Utama</a>
        </div>
    </div>

    <script>
        let historyNumbers = [], remainingNumbers = [], isDrawing = false, maxTotalNumbers = 100, maxAllowedDraws = 10, currentDrawCount = 0; function initializeNumbers() { maxTotalNumbers = Math.max(1, parseInt(document.getElementById('maxAngka').value) || 100); maxAllowedDraws = Math.min(maxTotalNumbers, parseInt(document.getElementById('maxDraw').value) || Math.min(10, maxTotalNumbers)); document.getElementById('maxAngka').value = maxTotalNumbers; document.getElementById('maxDraw').value = maxAllowedDraws; document.getElementById('maxDrawValue').textContent = maxAllowedDraws; historyNumbers = []; remainingNumbers = Array.from({length: maxTotalNumbers}, (_, i) => i + 1); currentDrawCount = 0; updateDisplay(); const resultElement = document.getElementById("result"); resultElement.textContent = "-"; resultElement.classList.remove('animate-pulse'); document.getElementById("drawButton").disabled = false; document.getElementById("drawButton").innerHTML = "<span>Ambil Nomor</span>"; } function generateLotteryNumber() { if (isDrawing || remainingNumbers.length === 0 || currentDrawCount >= maxAllowedDraws) { if (remainingNumbers.length === 0) alert("Semua nomor telah terambil."); else if (currentDrawCount >= maxAllowedDraws) alert("Telah mencapai batas maksimal pengambilan."); return; } isDrawing = true; currentDrawCount++; const resultElement = document.getElementById('result'); const drawButton = document.getElementById("drawButton"); resultElement.classList.add('animate-pulse'); drawButton.disabled = true; drawButton.innerHTML = "<span>Memproses...</span>"; setTimeout(() => { const randomIndex = Math.floor(Math.random() * remainingNumbers.length); const chosenNumber = remainingNumbers.splice(randomIndex, 1)[0]; historyNumbers.push(chosenNumber); resultElement.classList.remove('animate-pulse'); resultElement.textContent = chosenNumber; updateDisplay(); isDrawing = false; if (remainingNumbers.length === 0 || currentDrawCount >= maxAllowedDraws) { drawButton.innerHTML = "<span>Selesai</span>"; if (remainingNumbers.length === 0) alert("Semua nomor telah terpilih."); else if (currentDrawCount >= maxAllowedDraws) alert("Batas pengambilan nomor telah tercapai."); } else { drawButton.disabled = false; drawButton.innerHTML = "<span>Ambil Nomor</span>"; } }, 1500); } function updateDisplay() { const historyElement = document.getElementById("history"); const remainingElement = document.getElementById("remaining"); historyElement.innerHTML = historyNumbers.map(num => `<div class="bg-blue-500 text-white text-sm font-semibold px-3 py-1 rounded-full">${num}</div>`).reverse().join(''); remainingElement.innerHTML = remainingNumbers.map(num => `<div class="bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 text-sm font-semibold px-3 py-1 rounded-full">${num}</div>`).join(''); document.getElementById("drawCount").textContent = historyNumbers.length; document.getElementById("maxDrawValue").textContent = maxAllowedDraws; } document.getElementById("maxAngka").addEventListener("change", () => { if (historyNumbers.length > 0 && confirm("Mengubah total nomor akan mereset undian. Lanjutkan?")) { initializeNumbers(); } else if (historyNumbers.length === 0) { initializeNumbers(); } else { document.getElementById("maxAngka").value = maxTotalNumbers; } }); document.getElementById("maxDraw").addEventListener("change", () => { const newMaxDraw = parseInt(document.getElementById('maxDraw').value); const totalNumbers = parseInt(document.getElementById('maxAngka').value); if (newMaxDraw > totalNumbers) { alert("Maksimal pengambilan tidak boleh melebihi total nomor undian."); document.getElementById('maxDraw').value = Math.min(maxAllowedDraws, totalNumbers); return; } if (historyNumbers.length > 0 && confirm("Mengubah maksimal pengambilan akan mereset undian. Lanjutkan?")){ initializeNumbers(); } else if (historyNumbers.length === 0) { initializeNumbers(); } else { document.getElementById('maxDraw').value = maxAllowedDraws; } }); initializeNumbers();
    </script>
    <script>
        const themeToggle = document.getElementById('theme-toggle'); const sunIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>`; const moonIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>`; if (document.documentElement.classList.contains('dark')) { themeToggle.innerHTML = sunIcon; } else { themeToggle.innerHTML = moonIcon; } themeToggle.addEventListener('click', () => { if (document.documentElement.classList.contains('dark')) { document.documentElement.classList.remove('dark'); localStorage.setItem('theme', 'light'); themeToggle.innerHTML = moonIcon; } else { document.documentElement.classList.add('dark'); localStorage.setItem('theme', 'dark'); themeToggle.innerHTML = sunIcon; } });
    </script>
</body>
</html>